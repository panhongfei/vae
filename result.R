library(randomForest)
train_index<-sample(nrow(datalast),3*nrow(datalast)/4)
train<-datalast[train_index,]
test<-datalast[-train_index,]
rforest<-randomForest(train$V652~.,data=train)
predtest<-predict(rforest,test,type='response')
roctest<-roc(test$V652,predtest)
auc(roctest)
predtest1<-predict(rforest,test)
error<-predtest1-test$V652
abs(error)/nrow(test)
sum(abs(error))/nrow(test)
sum(abs(error))/nrow(test)-1
class(rforest)
str(rforest)
plot(roctest)
auc(roctest)
predicttrain<-predict(rforest,train,type='response')
roctrain<-roc(train$V652,predicttrain)
plot(roctrain)
auc(roctrain)
help("randomForest")
View(datalast)
dim(datalast)
write.csv(datalast,'datafinal.csv')
View(error)
View(predtest1)
predtest1<-predict(rforest,test)
View(predtest1)
predtest1[predtest1>=0.5]<-1
predtest1[predtest1<0.5]<-0
View(predtest1)
error<-predtest1-test$V652
sum(abs(error))/nrow(error)
sum(test$V652)
sum(error[error==1])
sum(error[error==1])/3987
sum(error[error==1])/3987-1
auctrain<-auc(roctrain)
auctrain
auctest<-auc(roctest)
auctest
tpr<-1-sum(error[error==1])/nrow(test$V652)
tpr<-1-sum(error[error==1])/length(test$V652)
tpr<-1-sum(error[error==1])/sum(test$V652)
tpr
fpr<-sum(error[error==1])/(1-sum(test$V652))
fpr
fpr<-sum(error[error==1])/(length(test$V652)-sum(test$V652))
fpr
resultfinal<-list(rforest,train,test,roctrain,roctest,auctrain,auctest,tpr,fpr,error)
resultfinal
View(resultfinal)
str(resultfinal)
resultfinal<-list(model=rforest,train=train,test=test,roctrain=roctrain,roctest=roctest,auctrain=auctrain,auctest=auctest,tpr=tpr,fpr=fpr,error=error)